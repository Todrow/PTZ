<!DOCTYPE html>
<html lang="ru">
    <head>
        {% load static %}
        <link rel="stylesheet" href="{% static 'doc.css' %}">
        <link rel="shortcut icon" href="{% static "13452_0_.jpg" %}">
        <title>Документация</title>
    </head>
    <body>
        <nav>
            <!-- Checkbox for toggling menu -->
            <input type="checkbox" id="check">          
        
            <!-- Site logo -->
            <label class="logo">ПТЗ</label>
        
            <!-- Navigation links -->
            <ul>
                <li><a href="merge_files/" class="link">объединить отчеты</a></li>
                <li><a href="format/" class="link">Форматировать отчет</a></li>
                <li><a class="link active" href="" class="link">Документация</a></li>
            </ul>
        </nav>
        <h1>Документация</h1>
        <p>
            Документация состоит из двух разделов:
        </p>
        <ul class="ul">
            <li class="li">- <a href="#userd_guide">Руководство для пользователей</a></li>
            <li class="li">- <a href="#dev_guide">Руководство для разработчиков</a></li>
        </ul>
        <div>
            <h2 div="users_guide">Руководство для пользователей</h2>
            <div>
                <h3>Навигация</h3>
                <figure>
                    <img src="{% static 'nav.png' %}">
                    <figcaption>Рис.1</figcaption>
                </figure>
                
                <p>Сверху на каждой странице находится навигационная панель, с помощью которой
                    можно попасть на различные страницы сайта. Далее дано краткое описание каждой из них:
                    <ul class="ul">
                        <li class="li">- <a href="#merge_files">объединить файлы</a>
                            - это форма позволяющая создать единый Excel отчет на основе выгрузки ПЭ из
                            Веб-Системы и Excel выгрузки задач из группы Подконтрольная эксплуатация в Битрикс.
                        </li>
                        <li class="li">- <a href="#format_file">Форматировать отчет</a>
                            - это форма позволяющая отформатировать отчет. Основным назначением является обработка
                            отчетов из веб-системы, так как в программе заложена возможность не только форматирования,
                            но и удаления некоторых столбцов в Excel файле выгрузки из данной системы.
                        </li>
                        <li class="li">- Документация
                            - это страница, предназначенная для описания работы сайта и инструкций по его редактированию.
                        </li>
                    </ul>
                </p>
                <div class="separator"></div>
            </div>
            <div>
                <h3 id="merge_files">Объединить отчеты</h3>
                <h4>Описание страницы "Объеденить отчеты"</h4>
                <figure>
                    <img src="{% static 'merge.png' %}">
                    <figcaption>Рис. 2</figcaption>
                </figure>
                <p>
                    Страница предназначенна для создания единого Excel отчета на основе выгрузки ПЭ из
                    Веб-Системы и Excel выгрузки задач из группы Подконтрольная эксплуатация в Битрикс.
                </p>
                <p>
                    Файлы Excel выгрузок из Битрикс и Веб-Системы необходимо загружать нажатием на соответсвующую кнопку
                    формы. Программа принимает файлы
                    <strong> только в формате .xlsx.</strong>
                    Для того, чтобы сменить старый формат файла (.xls) на новый (.xlsx), необходимо открыть его в 
                    Microsoft Excel и после нажатия на "Сохранить как" выбрать формат сохранения .xlsx
                </p>
                <p>Далее рассмотрен процесс создания выгрузок.</p>
                <div class="separator_small"></div>
                <h4>Создание выгрузки из Веб-Системы</h4>
                <p>
                    Файл выгрузки из Веб-Системы можно получть слудующим образом:
                </p>
                <figure>
                    <img src="{% static 'web_guide.png' %}">
                    <figcaption>Рис. 3</figcaption>
                </figure>
                <p>
                    Для получения выгрузки ПЭ необходимо перейти в раздел "Особенная техника", последовательно 
                    открыв "Парк" - "Особенная техника". Далее <strong>важно поставить опцию "Неограниченно"</strong>
                    в поле, отмеченным номером 3
                    на изображении выше. Далее необходимо <strong>поставить галочку у "Продукция"</strong>,
                    (4 на изображении)
                    для выделения всех записей. Далее необходимо нажать "Действие" и выбрать пункт "Выгрузка ПЭ".
                    В открывшемся окне сгенерируйте архив и сохраниет его.
                </p>
                <div class="separator_small"></div>
                <h4>Создание выгрузки из Битрикс</h4>
                <figure>
                    <img src="{% static 'bitrix.jpg' %}">
                    <figcaption>Рис. 4</figcaption>
                </figure>
                <p>
                    Для выгрузки отчета по Пожконтрольной эксплуатации из Битрикс зайдите в соответсвующую
                    группу, далее откройте задачи и выберите отображение в виде списка. После чего экспортируйте список в 
                    Excel, в соответствии с действиями, описанными на изображении выше. Обратите внимание, что во всплывающем
                    окне <strong>должна стоять галочка</strong> "Все поля задач"
                </p>
                <div class="separator_small"></div>
                <h4>После загрузки файлов</h4>
                <figure>
                    <img src="{% static 'save.png' %}" style="max-width: 500px;">
                    <figcaption>Рис. 5</figcaption>
                </figure>
                <p>
                    После загрузки файлов в форму, нажмите сохранить, это действие отправит все загруженные файлы на сервер.
                    По окончании обработки или при возникновении ошибки, сервер отправит ответ. В случае если все сработало 
                    в нормальном режиме появится окно с кнопкой скачать. В случае появления ошибки необходимо следовать инструкциям
                    из сообщения об ошибке.
                </p>
                <div class="separator"></div>
                
            </div>
            <div>
                <h3 id="format_file">Форматировать отчет</h3>
                <figure>
                    <img src="{% static 'format.png' %}">
                    <figcaption>Рис. 6</figcaption>
                </figure>
                <p>
                    На странице "Форматировать отчет" можно загрузить Excel выгрзку без форматирования и получить
                    готовый Excel файл, с отформатированными стилями. <strong>Важно</strong>, что
                    данная программа создана в первую очередь для редактирования Excel выгрузки из Веб-Системы, поэтому
                    изменения, вносимые в файл, носят <strong>не только</strong> косметический характер.
                    <p>При форматировании:</p>
                    <ul class="ul">
                        <li class="'li">Удаляются следующие столбцы: 'Вложения', 'Последний раз обновлено', 'Статус', 'Наименование сервисного центра'</li>
                        <li class="'li">Программа заполняет пропущенные значения во всех столбцах кроме: 'ПЭ: дата время', 'ПЭ: Комментарий', 'ПЭ: наработка м/ч'</li>
                    </ul>
                    

                </p>
                <div class="separator"></div>
            </div>
        </div>
        <div>
            <h2 id="dev_guide">Руководство для разработчиков</h2>
                <h4>
                    Перед прочтением руководства для разработчиков
                </h4>
                <p>
                    Перед прочтением руководства для разработчиков необходимо изучить руководство для пользователей, чтобы
                    понимать устройство и функционал программы. Далее в руководстве описана общая структура проекта. 
                    Чтобы получить подробную информацию о работе каждой части кода необходимо ознакомится с 
                    docstrings непосредственно в самом коде проекта.
                </p>
                <h4>Запуск сервера</h4>
                <p>
                    Для запуска сервера необходимо открыть командную строку, перейти в главную директорию проекта,
                    где находится файл manage.py и ввести команду runserver

                </p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyToClipboard(this)">Копировать</button>                
                    <pre id="code">
                        C:\Windows\system32>cd C:\...\PTZ\Excel

                        C:\Users\Aleksandr\Documents\Work\PTZ\Excel>py manage.py runserver
                    </pre>
                </div>
                <p>
                    Далее необходимо открыть в браузере http://localhost:8000/
                </p>
                <h4>Общие сведения</h4>
                <p>Сайт реализован на языке python, с использованием фреймворка
                    Django. Страницы созданы с использование html, css и js.
                </p>
                <h4>Общая структура проекта</h4>
                <div class="code-block">
                    <button class="copy-button" onclick="copyToClipboard(this)">Копировать</button>                
                    <pre id="code">
                        > Общая папка проекта
                                > Excel
                                        > doc
                                        > excel
                                                Главная папка
                                        > format_file
                                                Страница "Форматировать отчет"

                                        > merge_files
                                                Страница "Объединить отчеты"
                                        > scripts
                                                __init__.py
                                                xl_work_class.py
                                                exlWrapper.py
                                
                    </pre>
                </div>
                <p>
                    Структура проекта внутри папки каждой страницы описана далее.
                </p>
                <p>
                    В папке Scripts находятся файлы с классами Xl_work, который используетя при объединении двух
                    отчетов, и ExlWrapper, который фоматирует таблицу, удаляет некоторые столбцы и дозаполняет пропуски.
                </p>
                <h4>Структура страницы</h4>
            <div class="code-block">
                <button class="copy-button" onclick="copyToClipboard(this)">Копировать</button>                
                <pre id="code">
                    > Общая папка страницы
                            > migrations
                            > static
                                    img.png
                                    page.css
                                    page.js
                            > templates
                                    page.html
                            
                            __init__.py
                            admin.py
                            apps.py
                            models.py
                            tests.py
                            urls.py
                            views.py
                </pre>
            </div>
            <p>
                Во views.py находится логика взаимодействие с пользователем. Там находятся фнкции, 
                описывающие принятия запросов, рендера страниц, отправки сообщений пользователю и непосредственно сама
                обработка файлов.
            </p>
            <p>
                В urls.py описана обработка переходов по всем url, включая перенаправления и запуск функций 
                рендера различных html templates, которые описаны во views.py
            </p>
        </div>
        <script src="{% static "doc.js" %}"></script>
    </body>